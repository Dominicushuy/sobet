# Phân tích Hệ thống Cá Cược Xổ Số

## 1. Danh sách các loại cược

Từ tài liệu, tôi đã xác định 8 loại cược chính:

1. **Đầu Đuôi (dd)** - Cược dựa trên 2 chữ số (00-99)
2. **Xỉu Chủ (xc)** - Cược dựa trên 3 chữ số (000-999)
3. **Bao Lô (b2, b3, b4)** - Cược với N chữ số (N = 2, 3 hoặc 4)
4. **Bao 7 Lô (b7l)** - Tập hợp con của bao lô, áp dụng cho 7 lô cụ thể ở M1
5. **Bao 8 Lô (b8l)** - Tập hợp con của bao lô, áp dụng cho 8 lô cụ thể ở M2
6. **Nhất To (nt)** - Cược dựa trên 2 số cuối của giải Nhất (M2)
7. **Xiên (x)** - Cược nhiều cặp số, tất cả đều phải về (M2)
8. **Đá (da)** - Cược nhiều cặp số với nhiều trường hợp trúng (M1)

## 2. Tóm tắt chi tiết cho mỗi loại cược

### 2.1 Đầu Đuôi (dd)

- **Nguyên tắc cơ bản**:

  - Cược 2 chữ số (00-99)
  - Đầu: Khớp với số ở giải 8 (M1) hoặc giải 7 (M2)
  - Đuôi: Khớp với 2 số cuối của giải Đặc Biệt

- **Tiền đóng**:

  - Cược đầu đuôi (dd): M1 (mệnh giá×2), M2 (mệnh giá×5)
  - Chỉ đầu (dau): M1 (mệnh giá×1), M2 (mệnh giá×4)
  - Chỉ đuôi (duoi): M1 và M2 (mệnh giá×1)

- **Tỷ lệ thắng**: 1:75
- **Áp dụng cho**: Cả M1 và M2

### 2.2 Xỉu Chủ (xc)

- **Nguyên tắc cơ bản**:

  - Cược 3 chữ số (000-999)
  - Đầu: Khớp với số ở giải 7 (M1) hoặc giải 6 (M2)
  - Đuôi: Khớp với 3 số cuối của giải Đặc Biệt

- **Tiền đóng**:

  - Xỉu chủ toàn phần (xc): M1 (mệnh giá×2), M2 (mệnh giá×4)
  - Chỉ đầu (dau): M1 (mệnh giá×1), M2 (mệnh giá×3)
  - Chỉ đuôi (duoi): M1 và M2 (mệnh giá×1)

- **Tỷ lệ thắng**: 1:650
- **Áp dụng cho**: Cả M1 và M2

### 2.3 Bao Lô N (b2, b3, b4)

- **Nguyên tắc cơ bản**:

  - Cược N chữ số (N = 2, 3 hoặc 4)
  - Số cược khớp với N số cuối của bất kỳ lô nào

- **Tiền đóng**:

  - b2: M1 (mệnh giá×18), M2 (mệnh giá×27)
  - b3: M1 (mệnh giá×17), M2 (mệnh giá×23)
  - b4: M1 (mệnh giá×16), M2 (mệnh giá×20)

- **Tỷ lệ thắng**:

  - b2: 1:75
  - b3: 1:650
  - b4: 1:5500

- **Áp dụng cho**: Cả M1 và M2

### 2.4 Bao 7 Lô (b7l)

- **Nguyên tắc cơ bản**:

  - Tập hợp con của bao lô, áp dụng cho 7 lô cụ thể
  - Cược khớp với 2, 3, hoặc 4 số cuối của các lô này

- **Tiền đóng**: M1 (mệnh giá×7)
- **Tỷ lệ thắng**: 2 số (1:75), 3 số (1:650), 4 số (1:5500)
- **Áp dụng cho**: Chủ yếu M1

### 2.5 Bao 8 Lô (b8l)

- **Nguyên tắc cơ bản**:

  - Tập hợp con của bao lô, áp dụng cho 8 lô cụ thể
  - Cược khớp với 2, 3, hoặc 4 số cuối của các lô này

- **Tiền đóng**: M2 (mệnh giá×8)
- **Tỷ lệ thắng**: 2 số (1:75), 3 số (1:650), 4 số (1:5500)
- **Áp dụng cho**: Chủ yếu M2

### 2.6 Nhất To (nt)

- **Nguyên tắc cơ bản**: Cược khớp với 2 số cuối của giải Nhất
- **Tiền đóng**: M2 (mệnh giá×1)
- **Tỷ lệ thắng**: 1:75
- **Áp dụng cho**: Chủ yếu M2

### 2.7 Xiên (x)

- **Nguyên tắc cơ bản**:

  - Chọn 2, 3 hoặc 4 cặp số 2 chữ số
  - Tất cả các số phải về mới thắng

- **Tiền đóng**: M2 (mệnh giá×27)
- **Tỷ lệ thắng**: x2 (1:75), x3 (1:40), x4 (1:250)
- **Áp dụng cho**: Chủ yếu M2

### 2.8 Đá (da)

- **Nguyên tắc cơ bản**:

  - Chọn 2-5 cặp số 2 chữ số
  - Nhiều trường hợp trúng thưởng khác nhau

- **Tiền đóng**: da2 (×1), da3 (×3), da4 (×6), da5 (×10)
- **Tỷ lệ thắng**: Nhiều tỷ lệ khác nhau dựa trên kết quả
- **Áp dụng cho**: Chủ yếu M1

## 3. Object JSON về các loại cược

```json
{
  "betTypes": [
    {
      "id": "dd",
      "name": "Đầu Đuôi",
      "description": "Đặt cược dựa trên 2 chữ số (00-99)",
      "digitCount": 2,
      "variants": [
        {
          "id": "dd",
          "name": "Đầu Đuôi",
          "description": "Đặt cược cả đầu và đuôi"
        },
        {
          "id": "dau",
          "name": "Chỉ Đầu",
          "description": "Đặt cược chỉ ở đầu"
        },
        {
          "id": "duoi",
          "name": "Chỉ Đuôi",
          "description": "Đặt cược chỉ ở đuôi"
        }
      ],
      "regions": [
        {
          "id": "M1",
          "name": "Miền Nam và Miền Trung",
          "betMultipliers": {
            "dd": 2,
            "dau": 1,
            "duoi": 1
          },
          "combinationCount": {
            "dd": 2,
            "dau": 1,
            "duoi": 1
          },
          "winningRules": {
            "dau": "Khớp với số ở giải 8",
            "duoi": "Khớp với 2 số cuối của giải Đặc Biệt"
          }
        },
        {
          "id": "M2",
          "name": "Miền Bắc",
          "betMultipliers": {
            "dd": 5,
            "dau": 4,
            "duoi": 1
          },
          "combinationCount": {
            "dd": 5,
            "dau": 4,
            "duoi": 1
          },
          "winningRules": {
            "dau": "Khớp với số ở giải 7",
            "duoi": "Khớp với 2 số cuối của giải Đặc Biệt"
          }
        }
      ],
      "winningRatio": 75
    },
    {
      "id": "xc",
      "name": "Xỉu Chủ",
      "description": "Đặt cược dựa trên 3 chữ số (000-999)",
      "digitCount": 3,
      "variants": [
        {
          "id": "xc",
          "name": "Xỉu Chủ Toàn Phần",
          "description": "Đặt cược cả đầu và đuôi"
        },
        {
          "id": "dau",
          "name": "Chỉ Đầu",
          "description": "Đặt cược chỉ ở đầu"
        },
        {
          "id": "duoi",
          "name": "Chỉ Đuôi",
          "description": "Đặt cược chỉ ở đuôi"
        }
      ],
      "regions": [
        {
          "id": "M1",
          "name": "Miền Nam và Miền Trung",
          "betMultipliers": {
            "xc": 2,
            "dau": 1,
            "duoi": 1
          },
          "combinationCount": {
            "xc": 2,
            "dau": 1,
            "duoi": 1
          },
          "winningRules": {
            "dau": "Khớp với số ở giải 7",
            "duoi": "Khớp với 3 số cuối của giải Đặc Biệt"
          }
        },
        {
          "id": "M2",
          "name": "Miền Bắc",
          "betMultipliers": {
            "xc": 4,
            "dau": 3,
            "duoi": 1
          },
          "combinationCount": {
            "xc": 4,
            "dau": 3,
            "duoi": 1
          },
          "winningRules": {
            "dau": "Khớp với số ở giải 6",
            "duoi": "Khớp với 3 số cuối của giải Đặc Biệt"
          }
        }
      ],
      "winningRatio": 650
    },
    {
      "id": "bao_lo",
      "name": "Bao Lô N",
      "description": "Đặt cược với N chữ số (N = 2, 3 hoặc 4)",
      "variants": [
        {
          "id": "b2",
          "name": "Bao Lô 2",
          "digitCount": 2,
          "description": "Đặt cược với 2 chữ số"
        },
        {
          "id": "b3",
          "name": "Bao Lô 3",
          "digitCount": 3,
          "description": "Đặt cược với 3 chữ số"
        },
        {
          "id": "b4",
          "name": "Bao Lô 4",
          "digitCount": 4,
          "description": "Đặt cược với 4 chữ số"
        }
      ],
      "regions": [
        {
          "id": "M1",
          "name": "Miền Nam và Miền Trung",
          "betMultipliers": {
            "b2": 18,
            "b3": 17,
            "b4": 16
          },
          "combinationCount": {
            "b2": 18,
            "b3": 17,
            "b4": 16
          },
          "winningRules": "Số cược khớp với N số cuối của bất kỳ lô nào trong các giải"
        },
        {
          "id": "M2",
          "name": "Miền Bắc",
          "betMultipliers": {
            "b2": 27,
            "b3": 23,
            "b4": 20
          },
          "combinationCount": {
            "b2": 27,
            "b3": 23,
            "b4": 20
          },
          "winningRules": "Số cược khớp với N số cuối của bất kỳ lô nào trong các giải"
        }
      ],
      "winningRatio": {
        "b2": 75,
        "b3": 650,
        "b4": 5500
      }
    },
    {
      "id": "b7l",
      "name": "Bao 7 Lô",
      "description": "Tập hợp con của bao lô 2, 3, 4, áp dụng cho 7 lô nhất định",
      "variants": [
        {
          "id": "b7l2",
          "name": "Bao 7 Lô (2 chữ số)",
          "digitCount": 2,
          "description": "Đặt cược với 2 chữ số"
        },
        {
          "id": "b7l3",
          "name": "Bao 7 Lô (3 chữ số)",
          "digitCount": 3,
          "description": "Đặt cược với 3 chữ số"
        },
        {
          "id": "b7l4",
          "name": "Bao 7 Lô (4 chữ số)",
          "digitCount": 4,
          "description": "Đặt cược với 4 chữ số"
        }
      ],
      "regions": [
        {
          "id": "M1",
          "name": "Miền Nam và Miền Trung",
          "betMultipliers": {
            "b7l2": 7,
            "b7l3": 7,
            "b7l4": 7
          },
          "combinationCount": 7,
          "winningRules": "Số cược khớp với N số cuối của 7 lô đặc biệt (giải tám, giải bảy, giải sáu, giải năm, giải đặc biệt)"
        }
      ],
      "winningRatio": {
        "b7l2": 75,
        "b7l3": 650,
        "b7l4": 5500
      }
    },
    {
      "id": "b8l",
      "name": "Bao 8 Lô",
      "description": "Tập hợp con của bao lô 2, 3, 4, áp dụng cho 8 lô nhất định",
      "variants": [
        {
          "id": "b8l2",
          "name": "Bao 8 Lô (2 chữ số)",
          "digitCount": 2,
          "description": "Đặt cược với 2 chữ số"
        },
        {
          "id": "b8l3",
          "name": "Bao 8 Lô (3 chữ số)",
          "digitCount": 3,
          "description": "Đặt cược với 3 chữ số"
        },
        {
          "id": "b8l4",
          "name": "Bao 8 Lô (4 chữ số)",
          "digitCount": 4,
          "description": "Đặt cược với 4 chữ số"
        }
      ],
      "regions": [
        {
          "id": "M2",
          "name": "Miền Bắc",
          "betMultipliers": {
            "b8l2": 8,
            "b8l3": 8,
            "b8l4": 8
          },
          "combinationCount": 8,
          "winningRules": "Số cược khớp với N số cuối của 8 lô đặc biệt (giải đặc biệt, giải bảy, giải sáu, giải năm, giải tư, giải ba)"
        }
      ],
      "winningRatio": {
        "b8l2": 75,
        "b8l3": 650,
        "b8l4": 5500
      }
    },
    {
      "id": "nt",
      "name": "Nhất To",
      "description": "Đặt cược dựa trên 2 số cuối của giải Nhất",
      "digitCount": 2,
      "regions": [
        {
          "id": "M2",
          "name": "Miền Bắc",
          "betMultipliers": 1,
          "combinationCount": 1,
          "winningRules": "Số cược khớp với 2 số cuối của giải Nhất"
        }
      ],
      "winningRatio": 75
    },
    {
      "id": "xien",
      "name": "Xiên",
      "description": "Đặt cược với nhiều cặp số 2 chữ số",
      "digitCount": 2,
      "variants": [
        {
          "id": "x2",
          "name": "Xiên 2",
          "description": "Chọn 2 cặp số",
          "numberCount": 2
        },
        {
          "id": "x3",
          "name": "Xiên 3",
          "description": "Chọn 3 cặp số",
          "numberCount": 3
        },
        {
          "id": "x4",
          "name": "Xiên 4",
          "description": "Chọn 4 cặp số",
          "numberCount": 4
        }
      ],
      "regions": [
        {
          "id": "M2",
          "name": "Miền Bắc",
          "betMultipliers": 27,
          "combinationCount": 27,
          "winningRules": "Tất cả các số được chọn phải xuất hiện trong kết quả (2 số cuối của các lô)"
        }
      ],
      "winningRatio": {
        "x2": 75,
        "x3": 40,
        "x4": 250
      }
    },
    {
      "id": "da",
      "name": "Đá",
      "description": "Đặt cược với nhiều cặp số 2 chữ số, có nhiều trường hợp trúng",
      "digitCount": 2,
      "variants": [
        {
          "id": "da2",
          "name": "Đá 2",
          "description": "Chọn 2 cặp số",
          "numberCount": 2
        },
        {
          "id": "da3",
          "name": "Đá 3",
          "description": "Chọn 3 cặp số",
          "numberCount": 3
        },
        {
          "id": "da4",
          "name": "Đá 4",
          "description": "Chọn 4 cặp số",
          "numberCount": 4
        },
        {
          "id": "da5",
          "name": "Đá 5",
          "description": "Chọn 5 cặp số",
          "numberCount": 5
        }
      ],
      "regions": [
        {
          "id": "M1",
          "name": "Miền Nam và Miền Trung",
          "betMultipliers": {
            "da2": 1,
            "da3": 3,
            "da4": 6,
            "da5": 10
          },
          "combinationCount": {
            "da2": 1,
            "da3": 3,
            "da4": 6,
            "da5": 10
          },
          "winningRules": "Nhiều trường hợp trúng thưởng khác nhau dựa trên số lượng số trúng và số lần xuất hiện"
        }
      ],
      "winningRatio": {
        "da2": {
          "2_numbers": 12.5
        },
        "da3": {
          "3_numbers": 37.5,
          "3_numbers_1_number_3_times": 112.5,
          "3_numbers_1_number_2_times": 75,
          "2_numbers_1_number_2_times": 43.75,
          "2_numbers_no_doubles": 25
        },
        "da4": {
          "4_numbers": 250,
          "3_numbers_1_number_3_times": 750,
          "3_numbers_1_number_2_times": 500,
          "2_numbers_2_number_2_times": 150,
          "2_numbers_1_number_2_times": 75
        },
        "da5": {
          "5_numbers": 1250,
          "4_numbers_1_number_3_times": 3750,
          "4_numbers_1_number_2_times": 2500,
          "3_numbers_2_number_2_times": 750,
          "3_numbers_1_number_2_times": 500
        }
      }
    }
  ],
  "numberSelectionMethods": [
    {
      "id": "manual",
      "name": "Nhập Trực Tiếp",
      "description": "Nhập từng số cụ thể theo định dạng yêu cầu"
    },
    {
      "id": "zodiac",
      "name": "12 Con Giáp",
      "description": "Tạo tự động các số dựa trên 12 con giáp trong văn hóa Á Đông",
      "options": [
        {
          "id": "ty",
          "name": "Tý",
          "value": 0,
          "numbers": ["00", "12", "24", "36", "48", "60", "72", "84", "96"]
        },
        {
          "id": "suu",
          "name": "Sửu",
          "value": 1,
          "numbers": ["01", "13", "25", "37", "49", "61", "73", "85", "97"]
        },
        {
          "id": "dan",
          "name": "Dần",
          "value": 2,
          "numbers": ["02", "14", "26", "38", "50", "62", "74", "86", "98"]
        },
        {
          "id": "mao",
          "name": "Mão",
          "value": 3,
          "numbers": ["03", "15", "27", "39", "51", "63", "75", "87", "99"]
        },
        {
          "id": "thin",
          "name": "Thìn",
          "value": 4,
          "numbers": ["04", "16", "28", "40", "52", "64", "76", "88"]
        },
        {
          "id": "ty_snake",
          "name": "Tỵ",
          "value": 5,
          "numbers": ["05", "17", "29", "41", "53", "65", "77", "89"]
        },
        {
          "id": "ngo",
          "name": "Ngọ",
          "value": 6,
          "numbers": ["06", "18", "30", "42", "54", "66", "78", "90"]
        },
        {
          "id": "mui",
          "name": "Mùi",
          "value": 7,
          "numbers": ["07", "19", "31", "43", "55", "67", "79", "91"]
        },
        {
          "id": "than",
          "name": "Thân",
          "value": 8,
          "numbers": ["08", "20", "32", "44", "56", "68", "80", "92"]
        },
        {
          "id": "dau",
          "name": "Dậu",
          "value": 9,
          "numbers": ["09", "21", "33", "45", "57", "69", "81", "93"]
        },
        {
          "id": "tuat",
          "name": "Tuất",
          "value": 10,
          "numbers": ["10", "22", "34", "46", "58", "70", "82", "94"]
        },
        {
          "id": "hoi",
          "name": "Hợi",
          "value": 11,
          "numbers": ["11", "23", "35", "47", "59", "71", "83", "95"]
        }
      ]
    },
    {
      "id": "permutation",
      "name": "Đảo Số",
      "description": "Tạo ra tất cả các hoán vị có thể có của một số",
      "variants": [
        {
          "id": "perm2",
          "name": "Đảo 2 số",
          "digitCount": 2,
          "maxPermutations": 2
        },
        {
          "id": "perm3",
          "name": "Đảo 3 số",
          "digitCount": 3,
          "maxPermutations": 6
        },
        {
          "id": "perm4",
          "name": "Đảo 4 số",
          "digitCount": 4,
          "maxPermutations": 24
        }
      ]
    },
    {
      "id": "highlow",
      "name": "Tài - Xỉu",
      "description": "Tạo tự động tất cả các số trong nhóm Tài hoặc Xỉu",
      "options": [
        {
          "id": "tai",
          "name": "Tài",
          "description": "Các số từ 50-99",
          "range": [50, 99]
        },
        {
          "id": "xiu",
          "name": "Xỉu",
          "description": "Các số từ 00-49",
          "range": [0, 49]
        }
      ]
    },
    {
      "id": "evenodd",
      "name": "Chẵn - Lẻ",
      "description": "Tạo tự động tất cả các số chẵn hoặc lẻ",
      "options": [
        {
          "id": "even",
          "name": "Chẵn",
          "description": "Các số chẵn (00, 02, 04, ..., 98)",
          "formula": "n % 2 === 0"
        },
        {
          "id": "odd",
          "name": "Lẻ",
          "description": "Các số lẻ (01, 03, 05, ..., 99)",
          "formula": "n % 2 !== 0"
        }
      ]
    },
    {
      "id": "sequence",
      "name": "Kéo Số",
      "description": "Tạo tự động các số theo quy luật đặc biệt",
      "variants": [
        {
          "id": "tens",
          "name": "Kéo chục",
          "description": "Tạo 10 số có cùng hàng chục",
          "example": "Kéo chục 2 → 20, 21, 22, 23, 24, 25, 26, 27, 28, 29"
        },
        {
          "id": "units",
          "name": "Kéo đơn vị",
          "description": "Tạo 10 số có cùng hàng đơn vị",
          "example": "Kéo đơn vị 3 → 03, 13, 23, 33, 43, 53, 63, 73, 83, 93"
        },
        {
          "id": "doubles",
          "name": "Kéo Xỉu Chủ nhị (số đôi)",
          "description": "Tạo các số có 2 chữ số giống nhau",
          "numbers": ["11", "22", "33", "44", "55", "66", "77", "88", "99"]
        },
        {
          "id": "triples",
          "name": "Kéo Xỉu Chủ tam (số ba)",
          "description": "Tạo các số có 3 chữ số giống nhau",
          "numbers": ["111", "222", "333", "444", "555", "666", "777", "888", "999"]
        },
        {
          "id": "progression",
          "name": "Kéo xỉu lũy tiến (số tiến)",
          "description": "Tạo các số có 3 chữ số liên tiếp tăng dần",
          "numbers": ["123", "234", "345", "456", "567", "678", "789"]
        }
      ]
    }
  ]
}
```

## 4. Logic đối soát kết quả cho từng loại cược

### 4.1 Đầu Đuôi (dd)

**Logic đối soát**:

- Kiểm tra "đầu": Lấy số ở giải 8 (M1) hoặc các số ở giải 7 (M2), so sánh với số cược.
- Kiểm tra "đuôi": Lấy 2 số cuối của giải Đặc Biệt, so sánh với số cược.
- Nếu trùng, người chơi thắng mệnh giá × tỷ lệ thưởng (75).
- Có thể trúng nhiều lô, tiền thưởng sẽ được nhân tương ứng.

### 4.2 Xỉu Chủ (xc)

**Logic đối soát**:

- Kiểm tra "đầu": Lấy số ở giải 7 (M1) hoặc các số ở giải 6 (M2), so sánh với số cược.
- Kiểm tra "đuôi": Lấy 3 số cuối của giải Đặc Biệt, so sánh với số cược.
- Nếu trùng, người chơi thắng mệnh giá × tỷ lệ thưởng (650).
- Có thể trúng nhiều lô, tiền thưởng sẽ được nhân tương ứng.

### 4.3 Bao Lô N (b2, b3, b4)

**Logic đối soát**:

- Lấy tất cả các lô từ kết quả xổ số (theo miền).
- Với mỗi lô, lấy N số cuối (N = 2, 3 hoặc 4).
- So sánh với số cược, nếu trùng, người chơi thắng mệnh giá × tỷ lệ thưởng tương ứng.
- Có thể trúng nhiều lần nếu số cược xuất hiện trong nhiều lô.

### 4.4 Bao 7 Lô (b7l)

**Logic đối soát**:

- Chỉ áp dụng cho M1, lấy 7 lô đặc biệt (giải tám, giải bảy, giải sáu, giải năm, giải đặc biệt).
- Với mỗi lô, lấy N số cuối (N = 2, 3 hoặc 4).
- So sánh với số cược, nếu trùng, người chơi thắng mệnh giá × tỷ lệ thưởng tương ứng.

### 4.5 Bao 8 Lô (b8l)

**Logic đối soát**:

- Chỉ áp dụng cho M2, lấy 8 lô đặc biệt (giải đặc biệt, giải bảy, giải sáu, giải năm, giải tư, giải ba).
- Với mỗi lô, lấy N số cuối (N = 2, 3 hoặc 4).
- So sánh với số cược, nếu trùng, người chơi thắng mệnh giá × tỷ lệ thưởng tương ứng.

### 4.6 Nhất To (nt)

**Logic đối soát**:

- Lấy 2 số cuối của giải Nhất (M2).
- So sánh với số cược, nếu trùng, người chơi thắng mệnh giá × 75.

### 4.7 Xiên (x)

**Logic đối soát**:

- Lấy tất cả các số 2 chữ số cuối của các lô trong kết quả (M2).
- So sánh với mỗi cặp số trong cược Xiên.
- Người chơi chỉ thắng nếu TẤT CẢ các cặp số đều xuất hiện trong kết quả.
- Tỷ lệ thưởng phụ thuộc vào số lượng cặp số: Xiên 2 (75), Xiên 3 (40), Xiên 4 (250).

### 4.8 Đá (da)

**Logic đối soát**:

- Phức tạp nhất, có nhiều trường hợp trúng thưởng khác nhau.
- Lấy tất cả các số 2 chữ số cuối của các lô trong kết quả (M1).
- Kiểm tra mỗi cặp số trong cược Đá.
- Tính toán số lượng cặp số trúng và số lần xuất hiện của mỗi cặp.
- Áp dụng tỷ lệ thưởng tương ứng với kết quả trúng.

## 5. TypeScript interfaces cho JSON

```typescript
// Interfaces cho các loại cược
export interface BetTypeVariant {
  id: string;
  name: string;
  description: string;
  digitCount?: number;
  numberCount?: number;
}

export interface BetTypeRegionRules {
  dau?: string;
  duoi?: string;
  [key: string]: string | undefined;
}

export interface BetTypeRegionMultipliers {
  [key: string]: number;
}

export interface BetTypeRegionCombinationCount {
  [key: string]: number;
}

export interface BetTypeRegion {
  id: string;
  name: string;
  betMultipliers: number | BetTypeRegionMultipliers;
  combinationCount: number | BetTypeRegionCombinationCount;
  winningRules: string | BetTypeRegionRules;
}

export interface BetTypeWinningRatio {
  [key: string]:
    | number
    | {
        [key: string]: number;
      };
}

export interface BetType {
  id: string;
  name: string;
  description: string;
  digitCount?: number;
  variants?: BetTypeVariant[];
  regions: BetTypeRegion[];
  winningRatio: number | BetTypeWinningRatio;
}

// Interfaces cho phương thức chọn số
export interface ZodiacOption {
  id: string;
  name: string;
  value: number;
  numbers: string[];
}

export interface PermutationVariant {
  id: string;
  name: string;
  digitCount: number;
  maxPermutations: number;
}

export interface HighLowOption {
  id: string;
  name: string;
  description: string;
  range: [number, number];
}

export interface EvenOddOption {
  id: string;
  name: string;
  description: string;
  formula: string;
}

export interface SequenceVariant {
  id: string;
  name: string;
  description: string;
  example?: string;
  numbers?: string[];
}

export interface NumberSelectionMethod {
  id: string;
  name: string;
  description: string;
  options?: ZodiacOption[] | HighLowOption[] | EvenOddOption[];
  variants?: PermutationVariant[] | SequenceVariant[];
}

// Root interface
export interface LotteryData {
  betTypes: BetType[];
  numberSelectionMethods: NumberSelectionMethod[];
}

// Cấu trúc kết quả xổ số miền Bắc
export interface MienBacResult {
  tinh: string;
  ngay: string;
  thu: string;
  loaiVe: string;
  ketQua: {
    giaiDacBiet: string[];
    giaiNhat: string[];
    giaiNhi: string[];
    giaiBa: string[];
    giaiTu: string[];
    giaiNam: string[];
    giaiSau: string[];
    giaiBay: string[];
  };
}

// Cấu trúc kết quả xổ số miền Trung và miền Nam
export interface RegionalResult {
  tinh: string;
  maTinh: string;
  ketQua: {
    giaiDacBiet: string[];
    giaiNhat: string[];
    giaiNhi: string[];
    giaiBa: string[];
    giaiTu: string[];
    giaiNam: string[];
    giaiSau: string[];
    giaiBay: string[];
    giaiTam: string[];
  };
}

export interface MienTrungNamResult {
  ngay: string;
  thu: string;
  cacTinh: RegionalResult[];
}

// Cấu trúc kết quả xổ số tổng hợp
export interface LotteryResult {
  metadata: {
    version: string;
    nguon: string;
    ngayLayDuLieu: string;
    tongSoMien: number;
    tongSoNgay: number;
    thuDaLay: string;
    ngayDaLay: string;
    quyTacApDung: string;
  };
  duLieu: {
    [key: string]: {
      'mien-bac': MienBacResult;
      'mien-trung': MienTrungNamResult;
      'mien-nam': MienTrungNamResult;
    };
  };
}

// Cấu trúc thông tin tỉnh theo ngày
export interface ProvinceInfo {
  tinh: string;
  maTinh?: string;
  ngay: string;
  thu: string;
  mien: string;
}

export interface ProvincesByDay {
  metadata: {
    version: string;
    nguon: string;
    ngayLayDuLieu: string;
    tongSoMien: number;
    tongSoNgay: number;
  };
  duLieu: {
    [key: string]: {
      'mien-bac': ProvinceInfo[];
      'mien-trung': ProvinceInfo[];
      'mien-nam': ProvinceInfo[];
    };
  };
}

// Interface cho cược
export interface Bet {
  id: string;
  userId: string;
  betDate: string;
  drawDate: string;
  regionType: 'M1' | 'M2';
  province: string;
  betType: string;
  betVariant?: string;
  numbers: string[];
  selectionMethod: string;
  denomination: number;
  totalAmount: number;
  potentialWinAmount: number;
  status: 'pending' | 'won' | 'lost';
  winAmount?: number;
}
```

## 6. Utility Functions để tính toán tiền cược

```typescript
import { BetType, LotteryData, LotteryResult } from './types';

/**
 * Tính tổng tiền đóng dựa trên các thông số cược
 * @param betTypeId ID loại cược
 * @param betVariant ID biến thể cược (nếu có)
 * @param regionType Loại miền (M1, M2)
 * @param denomination Mệnh giá
 * @param numbersCount Số lượng số cược
 * @param lotteryData Dữ liệu loại cược
 * @returns Tổng tiền đóng
 */
export function calculateBetAmount(
  betTypeId: string,
  betVariant: string | undefined,
  regionType: 'M1' | 'M2',
  denomination: number,
  numbersCount: number,
  lotteryData: LotteryData
): number {
  // Tìm loại cược từ dữ liệu
  const betType = lotteryData.betTypes.find((bt) => bt.id === betTypeId);
  if (!betType) {
    throw new Error(`Không tìm thấy loại cược với ID: ${betTypeId}`);
  }

  // Tìm khu vực (miền) từ loại cược
  const region = betType.regions.find((r) => r.id === regionType);
  if (!region) {
    throw new Error(`Loại cược ${betTypeId} không hỗ trợ miền ${regionType}`);
  }

  // Lấy hệ số nhân theo biến thể
  let multiplier: number;

  if (typeof region.betMultipliers === 'number') {
    multiplier = region.betMultipliers;
  } else if (betVariant && region.betMultipliers[betVariant]) {
    multiplier = region.betMultipliers[betVariant];
  } else {
    throw new Error(`Không thể xác định hệ số nhân cho biến thể ${betVariant}`);
  }

  // Tính tổng tiền
  return denomination * multiplier * numbersCount;
}

/**
 * Tính số tiền tiềm năng thắng cho một số cược
 * @param betTypeId ID loại cược
 * @param betVariant ID biến thể cược (nếu có)
 * @param denomination Mệnh giá
 * @param lotteryData Dữ liệu loại cược
 * @returns Số tiền tiềm năng thắng
 */
export function calculatePotentialWinAmount(
  betTypeId: string,
  betVariant: string | undefined,
  denomination: number,
  lotteryData: LotteryData
): number {
  // Tìm loại cược từ dữ liệu
  const betType = lotteryData.betTypes.find((bt) => bt.id === betTypeId);
  if (!betType) {
    throw new Error(`Không tìm thấy loại cược với ID: ${betTypeId}`);
  }

  // Xác định tỷ lệ thưởng
  let winningRatio: number;

  if (typeof betType.winningRatio === 'number') {
    winningRatio = betType.winningRatio;
  } else if (betVariant && typeof betType.winningRatio[betVariant] === 'number') {
    winningRatio = betType.winningRatio[betVariant] as number;
  } else if (betVariant && typeof betType.winningRatio[betVariant] === 'object') {
    // Trường hợp đặc biệt cho cược "đá" - lấy tỷ lệ cao nhất
    const ratios = betType.winningRatio[betVariant] as Record<string, number>;
    winningRatio = Math.max(...Object.values(ratios));
  } else {
    throw new Error(`Không thể xác định tỷ lệ thưởng cho biến thể ${betVariant}`);
  }

  // Tính tiền thưởng tiềm năng
  return denomination * winningRatio;
}

/**
 * Tạo danh sách số tự động dựa trên phương thức chọn
 * @param selectionMethodId ID phương thức chọn số
 * @param variantId ID biến thể (nếu có)
 * @param params Tham số bổ sung (nếu cần)
 * @param lotteryData Dữ liệu loại cược
 * @returns Mảng các số được tạo
 */
export function generateNumbers(
  selectionMethodId: string,
  variantId: string | undefined,
  params: Record<string, any>,
  lotteryData: LotteryData
): string[] {
  const method = lotteryData.numberSelectionMethods.find((m) => m.id === selectionMethodId);
  if (!method) {
    throw new Error(`Không tìm thấy phương thức chọn số: ${selectionMethodId}`);
  }

  switch (selectionMethodId) {
    case 'zodiac': {
      // Tạo số dựa trên con giáp
      const selectedZodiac = params.zodiac;
      const zodiacOption = method.options?.find((o) => o.id === selectedZodiac);
      if (!zodiacOption) {
        throw new Error(`Không tìm thấy con giáp: ${selectedZodiac}`);
      }
      return (zodiacOption as any).numbers;
    }

    case 'permutation': {
      // Tạo hoán vị của số
      const baseNumber = params.baseNumber;
      if (!baseNumber) {
        throw new Error('Cần cung cấp số gốc để tạo hoán vị');
      }

      const variant = method.variants?.find((v) => v.id === variantId);
      if (!variant) {
        throw new Error(`Không tìm thấy biến thể đảo số: ${variantId}`);
      }

      return generatePermutations(baseNumber);
    }

    case 'highlow': {
      // Tạo số Tài hoặc Xỉu
      const option = params.option; // 'tai' hoặc 'xiu'
      const selectedOption = method.options?.find((o) => o.id === option);
      if (!selectedOption) {
        throw new Error(`Không tìm thấy tùy chọn: ${option}`);
      }

      const [min, max] = (selectedOption as any).range;
      const numbers: string[] = [];

      for (let i = min; i <= max; i++) {
        numbers.push(i.toString().padStart(2, '0'));
      }

      return numbers;
    }

    case 'evenodd': {
      // Tạo số chẵn hoặc lẻ
      const option = params.option; // 'even' hoặc 'odd'
      const isEven = option === 'even';
      const numbers: string[] = [];

      for (let i = 0; i <= 99; i++) {
        if ((i % 2 === 0 && isEven) || (i % 2 !== 0 && !isEven)) {
          numbers.push(i.toString().padStart(2, '0'));
        }
      }

      return numbers;
    }

    case 'sequence': {
      // Tạo dãy số theo quy luật
      const variant = method.variants?.find((v) => v.id === variantId);
      if (!variant) {
        throw new Error(`Không tìm thấy biến thể kéo số: ${variantId}`);
      }

      if ((variant as any).numbers) {
        return (variant as any).numbers;
      }

      if (variantId === 'tens') {
        // Kéo chục
        const tens = params.value;
        const numbers: string[] = [];

        for (let i = 0; i <= 9; i++) {
          numbers.push(`${tens}${i}`);
        }

        return numbers;
      }

      if (variantId === 'units') {
        // Kéo đơn vị
        const units = params.value;
        const numbers: string[] = [];

        for (let i = 0; i <= 9; i++) {
          numbers.push(`${i}${units}`);
        }

        return numbers;
      }

      return [];
    }

    default:
      return [];
  }
}

/**
 * Tạo tất cả các hoán vị có thể có của một số
 * @param number Số gốc
 * @returns Mảng các hoán vị
 */
export function generatePermutations(number: string): string[] {
  const digits = number.split('');
  const result: string[] = [];

  // Hàm đệ quy tạo hoán vị
  function permute(arr: string[], m: string[] = []) {
    if (arr.length === 0) {
      result.push(m.join(''));
    } else {
      for (let i = 0; i < arr.length; i++) {
        const curr = arr.slice();
        const next = curr.splice(i, 1);
        permute(curr, m.concat(next));
      }
    }
  }

  permute(digits);

  // Loại bỏ các hoán vị trùng lặp
  return [...new Set(result)];
}

/**
 * Kiểm tra kết quả cho loại cược đầu đuôi
 * @param number Số cược
 * @param variant Biến thể ('dd', 'dau', 'duoi')
 * @param regionType Loại miền (M1, M2)
 * @param result Kết quả xổ số
 * @returns Số lần trúng
 */
export function checkDauDuoiResult(
  number: string,
  variant: string,
  regionType: 'M1' | 'M2',
  result: LotteryResult
): number {
  const dayKey = Object.keys(result.duLieu)[0];
  let matches = 0;

  if (regionType === 'M1') {
    // Kiểm tra miền Nam hoặc miền Trung
    const regions = ['mien-nam', 'mien-trung'];

    for (const region of regions) {
      const regionalResult = result.duLieu[dayKey][region];

      for (const tinh of regionalResult.cacTinh) {
        // Kiểm tra đầu
        if (variant === 'dd' || variant === 'dau') {
          if (tinh.ketQua.giaiTam[0] === number) {
            matches++;
          }
        }

        // Kiểm tra đuôi
        if (variant === 'dd' || variant === 'duoi') {
          const dacBiet = tinh.ketQua.giaiDacBiet[0];
          const lastTwoDigits = dacBiet.slice(-2);

          if (lastTwoDigits === number) {
            matches++;
          }
        }
      }
    }
  } else {
    // Kiểm tra miền Bắc
    const bacResult = result.duLieu[dayKey]['mien-bac'];

    // Kiểm tra đầu
    if (variant === 'dd' || variant === 'dau') {
      for (const giaiBayNum of bacResult.ketQua.giaiBay) {
        if (giaiBayNum === number) {
          matches++;
        }
      }
    }

    // Kiểm tra đuôi
    if (variant === 'dd' || variant === 'duoi') {
      const dacBiet = bacResult.ketQua.giaiDacBiet[0];
      const lastTwoDigits = dacBiet.slice(-2);

      if (lastTwoDigits === number) {
        matches++;
      }
    }
  }

  return matches;
}

/**
 * Kiểm tra kết quả cho loại cược bao lô
 * @param number Số cược
 * @param digitCount Số chữ số (2, 3, 4)
 * @param regionType Loại miền (M1, M2)
 * @param result Kết quả xổ số
 * @returns Số lần trúng
 */
export function checkBaoLoResult(
  number: string,
  digitCount: number,
  regionType: 'M1' | 'M2',
  result: LotteryResult
): number {
  const dayKey = Object.keys(result.duLieu)[0];
  let matches = 0;

  // Hàm trích xuất N số cuối từ số kết quả
  const getLastNDigits = (resultNumber: string): string => {
    return resultNumber.slice(-digitCount);
  };

  if (regionType === 'M1') {
    // Kiểm tra miền Nam hoặc miền Trung
    const regions = ['mien-nam', 'mien-trung'];

    for (const region of regions) {
      const regionalResult = result.duLieu[dayKey][region];

      for (const tinh of regionalResult.cacTinh) {
        // Kiểm tra tất cả các giải
        const allPrizes = [
          ...tinh.ketQua.giaiDacBiet,
          ...tinh.ketQua.giaiNhat,
          ...tinh.ketQua.giaiNhi,
          ...tinh.ketQua.giaiBa,
          ...tinh.ketQua.giaiTu,
          ...tinh.ketQua.giaiNam,
          ...tinh.ketQua.giaiSau,
          ...tinh.ketQua.giaiBay,
          ...tinh.ketQua.giaiTam,
        ];

        for (const prize of allPrizes) {
          if (getLastNDigits(prize) === number) {
            matches++;
          }
        }
      }
    }
  } else {
    // Kiểm tra miền Bắc
    const bacResult = result.duLieu[dayKey]['mien-bac'];

    // Tổng hợp tất cả các giải
    const allPrizes = [
      ...bacResult.ketQua.giaiDacBiet,
      ...bacResult.ketQua.giaiNhat,
      ...bacResult.ketQua.giaiNhi,
      ...bacResult.ketQua.giaiBa,
      ...bacResult.ketQua.giaiTu,
      ...bacResult.ketQua.giaiNam,
      ...bacResult.ketQua.giaiSau,
      ...bacResult.ketQua.giaiBay,
    ];

    for (const prize of allPrizes) {
      if (getLastNDigits(prize) === number) {
        matches++;
      }
    }
  }

  return matches;
}

/**
 * Tính tổng số tiền thắng dựa trên kết quả
 * @param betTypeId ID loại cược
 * @param betVariant ID biến thể cược (nếu có)
 * @param numbers Danh sách số cược
 * @param regionType Loại miền (M1, M2)
 * @param denomination Mệnh giá
 * @param result Kết quả xổ số
 * @param lotteryData Dữ liệu loại cược
 * @returns Tổng số tiền thắng
 */
export function calculateWinAmount(
  betTypeId: string,
  betVariant: string | undefined,
  numbers: string[],
  regionType: 'M1' | 'M2',
  denomination: number,
  result: LotteryResult,
  lotteryData: LotteryData
): number {
  // Tìm loại cược từ dữ liệu
  const betType = lotteryData.betTypes.find((bt) => bt.id === betTypeId);
  if (!betType) {
    throw new Error(`Không tìm thấy loại cược với ID: ${betTypeId}`);
  }

  let totalWinAmount = 0;

  switch (betTypeId) {
    case 'dd': {
      // Xử lý đầu đuôi
      for (const number of numbers) {
        const matches = checkDauDuoiResult(number, betVariant || 'dd', regionType, result);
        if (matches > 0) {
          const winningRatio = betType.winningRatio as number;
          totalWinAmount += denomination * winningRatio * matches;
        }
      }
      break;
    }

    case 'xc': {
      // Xử lý xỉu chủ (tương tự đầu đuôi nhưng với 3 chữ số)
      // Cài đặt tương tự như đầu đuôi
      break;
    }

    case 'bao_lo': {
      // Xử lý bao lô
      const digitCount = betVariant === 'b2' ? 2 : betVariant === 'b3' ? 3 : 4;

      for (const number of numbers) {
        const matches = checkBaoLoResult(number, digitCount, regionType, result);
        if (matches > 0) {
          const winningRatio = (betType.winningRatio as any)[betVariant!];
          totalWinAmount += denomination * winningRatio * matches;
        }
      }
      break;
    }

    // Các loại cược khác sẽ có xử lý tương tự

    default:
      break;
  }

  return totalWinAmount;
}
```

## 7. TypeScript interfaces và JSON mẫu cho cấu trúc dữ liệu đài xổ số

```typescript
// TypeScript interfaces cho cấu trúc dữ liệu đài xổ số

// Interface cho thông tin cơ bản của một tỉnh
export interface Province {
  id: string;
  name: string;
  code?: string;
  region: 'mien-bac' | 'mien-trung' | 'mien-nam';
  regionType: 'M1' | 'M2';
  drawDays: string[]; // Các ngày trong tuần có xổ số, ví dụ: ['monday', 'thursday']
}

// Interface cho thông tin về ngày xổ cụ thể
export interface DrawDay {
  dayId: string; // Định danh của ngày, ví dụ: 'thu-hai', 'thu-ba', ...
  dayName: string; // Tên tiếng Việt, ví dụ: 'Thứ hai', 'Thứ ba', ...
  provinces: {
    'mien-bac': string[]; // Danh sách tỉnh miền Bắc
    'mien-trung': string[]; // Danh sách tỉnh miền Trung
    'mien-nam': string[]; // Danh sách tỉnh miền Nam
  };
}

// Interface cho lịch xổ số hàng tuần
export interface LotterySchedule {
  days: DrawDay[];
}

// Interface cho thông tin chi tiết một lô
export interface LotteryNumber {
  number: string;
  prize: string; // Loại giải, ví dụ: 'giaiDacBiet', 'giaiNhat', ...
}

// Interface cho kết quả xổ số của một tỉnh
export interface ProvincialResult {
  provinceId: string;
  provinceName: string;
  provinceCode?: string;
  date: string;
  dayOfWeek: string;
  results: {
    giaiDacBiet: string[];
    giaiNhat: string[];
    giaiNhi: string[];
    giaiBa: string[];
    giaiTu: string[];
    giaiNam: string[];
    giaiSau: string[];
    giaiBay: string[];
    giaiTam?: string[]; // Chỉ có ở miền Trung và miền Nam
  };
}

// Interface cho kết quả xổ số theo ngày
export interface DailyLotteryResult {
  date: string;
  dayOfWeek: string;
  results: {
    'mien-bac': ProvincialResult[];
    'mien-trung': ProvincialResult[];
    'mien-nam': ProvincialResult[];
  };
}

// JSON mẫu cho cấu trúc dữ liệu các tỉnh
const provincesData: Province[] = [
  {
    id: 'hanoi',
    name: 'Hà Nội',
    region: 'mien-bac',
    regionType: 'M2',
    drawDays: ['monday', 'thursday'],
  },
  {
    id: 'haiphong',
    name: 'Hải Phòng',
    region: 'mien-bac',
    regionType: 'M2',
    drawDays: ['friday'],
  },
  {
    id: 'quangninh',
    name: 'Quảng Ninh',
    region: 'mien-bac',
    regionType: 'M2',
    drawDays: ['tuesday'],
  },
  {
    id: 'tphcm',
    name: 'TP. HCM',
    code: 'XSHCM',
    region: 'mien-nam',
    regionType: 'M1',
    drawDays: ['monday', 'saturday'],
  },
  {
    id: 'cantho',
    name: 'Cần Thơ',
    code: 'XSCT',
    region: 'mien-nam',
    regionType: 'M1',
    drawDays: ['wednesday'],
  },
  {
    id: 'danang',
    name: 'Đà Nẵng',
    code: 'XSDNG',
    region: 'mien-trung',
    regionType: 'M1',
    drawDays: ['wednesday', 'saturday'],
  },
];

// JSON mẫu cho lịch xổ số hàng tuần
const weeklySchedule: LotterySchedule = {
  days: [
    {
      dayId: 'thu-hai',
      dayName: 'Thứ hai',
      provinces: {
        'mien-bac': ['Hà Nội'],
        'mien-trung': ['Phú Yên', 'Thừa T. Huế'],
        'mien-nam': ['TP. HCM', 'Đồng Tháp', 'Cà Mau'],
      },
    },
    {
      dayId: 'thu-ba',
      dayName: 'Thứ ba',
      provinces: {
        'mien-bac': ['Quảng Ninh'],
        'mien-trung': ['Đắk Lắk', 'Quảng Nam'],
        'mien-nam': ['Bến Tre', 'Vũng Tàu', 'Bạc Liêu'],
      },
    },
    {
      dayId: 'thu-tu',
      dayName: 'Thứ tư',
      provinces: {
        'mien-bac': ['Bắc Ninh'],
        'mien-trung': ['Đà Nẵng', 'Khánh Hòa'],
        'mien-nam': ['Đồng Nai', 'Cần Thơ', 'Sóc Trăng'],
      },
    },
    {
      dayId: 'thu-nam',
      dayName: 'Thứ năm',
      provinces: {
        'mien-bac': ['Hà Nội'],
        'mien-trung': ['Bình Định', 'Quảng Trị', 'Quảng Bình'],
        'mien-nam': ['Tây Ninh', 'An Giang', 'Bình Thuận'],
      },
    },
    {
      dayId: 'thu-sau',
      dayName: 'Thứ sáu',
      provinces: {
        'mien-bac': ['Hải Phòng'],
        'mien-trung': ['Gia Lai', 'Ninh Thuận'],
        'mien-nam': ['Vĩnh Long', 'Bình Dương', 'Trà Vinh'],
      },
    },
    {
      dayId: 'thu-bay',
      dayName: 'Thứ bảy',
      provinces: {
        'mien-bac': ['Nam Định'],
        'mien-trung': ['Đà Nẵng', 'Quảng Ngãi', 'Đắk Nông'],
        'mien-nam': ['TP. HCM', 'Long An', 'Bình Phước', 'Hậu Giang'],
      },
    },
    {
      dayId: 'chu-nhat',
      dayName: 'Chủ nhật',
      provinces: {
        'mien-bac': ['Thái Bình'],
        'mien-trung': ['Kon Tum', 'Khánh Hòa', 'Thừa T. Huế'],
        'mien-nam': ['Tiền Giang', 'Kiên Giang', 'Đà Lạt'],
      },
    },
  ],
};

// JSON mẫu cho kết quả xổ số hàng ngày
const dailyResult: DailyLotteryResult = {
  date: '2025-03-20',
  dayOfWeek: 'Thứ năm',
  results: {
    'mien-bac': [
      {
        provinceId: 'hanoi',
        provinceName: 'Hà Nội',
        date: '2025-03-20',
        dayOfWeek: 'Thứ năm',
        results: {
          giaiDacBiet: ['44025'],
          giaiNhat: ['37697'],
          giaiNhi: ['15242', '79057'],
          giaiBa: ['05226', '13883', '81103', '30037', '55390', '71825'],
          giaiTu: ['4782', '3605', '5314', '9268'],
          giaiNam: ['2380', '4954', '4843', '8579', '6981', '3164'],
          giaiSau: ['158', '605', '534'],
          giaiBay: ['75', '71', '37', '83'],
        },
      },
    ],
    'mien-trung': [
      {
        provinceId: 'binhdinh',
        provinceName: 'Bình Định',
        provinceCode: 'XSBDI',
        date: '2025-03-20',
        dayOfWeek: 'Thứ năm',
        results: {
          giaiDacBiet: ['283721'],
          giaiNhat: ['90976'],
          giaiNhi: ['99291'],
          giaiBa: ['82935', '81246'],
          giaiTu: ['67277', '95880', '83844', '73563', '44602', '03099', '10499'],
          giaiNam: ['5831'],
          giaiSau: ['4686', '5537', '3928'],
          giaiBay: ['410'],
          giaiTam: ['49'],
        },
      },
      {
        provinceId: 'quangtri',
        provinceName: 'Quảng Trị',
        provinceCode: 'XSQT',
        date: '2025-03-20',
        dayOfWeek: 'Thứ năm',
        results: {
          giaiDacBiet: ['674524'],
          giaiNhat: ['12575'],
          giaiNhi: ['37245'],
          giaiBa: ['46389', '72879'],
          giaiTu: ['51037', '33885', '46130', '57635', '64127', '35234', '02909'],
          giaiNam: ['7423'],
          giaiSau: ['5807', '1066', '6915'],
          giaiBay: ['659'],
          giaiTam: ['57'],
        },
      },
      {
        provinceId: 'quangbinh',
        provinceName: 'Quảng Bình',
        provinceCode: 'XSQB',
        date: '2025-03-20',
        dayOfWeek: 'Thứ năm',
        results: {
          giaiDacBiet: ['376935'],
          giaiNhat: ['09577'],
          giaiNhi: ['20158'],
          giaiBa: ['78115', '39835'],
          giaiTu: ['24943', '42532', '94911', '05163', '28958', '89915', '23578'],
          giaiNam: ['2470'],
          giaiSau: ['3636', '4347', '3216'],
          giaiBay: ['378'],
          giaiTam: ['37'],
        },
      },
    ],
    'mien-nam': [
      {
        provinceId: 'tayninh',
        provinceName: 'Tây Ninh',
        provinceCode: 'XSTN',
        date: '2025-03-20',
        dayOfWeek: 'Thứ năm',
        results: {
          giaiDacBiet: ['207932'],
          giaiNhat: ['40684'],
          giaiNhi: ['71781'],
          giaiBa: ['88539', '79913'],
          giaiTu: ['98234', '65895', '65058', '41791', '17416', '53704', '62509'],
          giaiNam: ['9034'],
          giaiSau: ['5942', '0495', '9717'],
          giaiBay: ['499'],
          giaiTam: ['85'],
        },
      },
      {
        provinceId: 'angiang',
        provinceName: 'An Giang',
        provinceCode: 'XSAG',
        date: '2025-03-20',
        dayOfWeek: 'Thứ năm',
        results: {
          giaiDacBiet: ['677111'],
          giaiNhat: ['96972'],
          giaiNhi: ['59000'],
          giaiBa: ['29554', '82669'],
          giaiTu: ['76233', '46033', '34847', '09666', '62624', '20428', '60677'],
          giaiNam: ['7146'],
          giaiSau: ['7664', '7901', '3870'],
          giaiBay: ['102'],
          giaiTam: ['43'],
        },
      },
      {
        provinceId: 'binhthuanthuan',
        provinceName: 'Bình Thuận',
        provinceCode: 'XSBTH',
        date: '2025-03-20',
        dayOfWeek: 'Thứ năm',
        results: {
          giaiDacBiet: ['403045'],
          giaiNhat: ['05159'],
          giaiNhi: ['22258'],
          giaiBa: ['64130', '47343'],
          giaiTu: ['41358', '65458', '88137', '50633', '60457', '89931', '07722'],
          giaiNam: ['3086'],
          giaiSau: ['3521', '4951', '8587'],
          giaiBay: ['386'],
          giaiTam: ['34'],
        },
      },
    ],
  },
};

// Cấu trúc database cho Supabase
export interface DatabaseStructure {
  provinces: {
    id: string;
    name: string;
    code?: string;
    region: string;
    region_type: string;
    draw_days: string[];
    created_at: string;
    updated_at: string;
  };

  lottery_results: {
    id: string;
    province_id: string;
    date: string;
    day_of_week: string;
    special_prize: string[];
    first_prize: string[];
    second_prize: string[];
    third_prize: string[];
    fourth_prize: string[];
    fifth_prize: string[];
    sixth_prize: string[];
    seventh_prize: string[];
    eighth_prize?: string[];
    created_at: string;
    updated_at: string;
  };

  bets: {
    id: string;
    user_id: string;
    bet_date: string;
    draw_date: string;
    region_type: string;
    province_id: string;
    bet_type: string;
    bet_variant?: string;
    numbers: string[];
    selection_method: string;
    denomination: number;
    total_amount: number;
    potential_win_amount: number;
    status: string;
    win_amount?: number;
    created_at: string;
    updated_at: string;
  };

  users: {
    id: string;
    email: string;
    name: string;
    phone?: string;
    balance: number;
    created_at: string;
    updated_at: string;
  };

  transactions: {
    id: string;
    user_id: string;
    bet_id?: string;
    amount: number;
    type: string;
    status: string;
    description: string;
    created_at: string;
    updated_at: string;
  };
}
```

# Tóm tắt phân tích hệ thống cá cược xổ số

Tôi đã hoàn thành phân tích chi tiết về hệ thống cá cược xổ số dựa trên tài liệu được cung cấp. Dưới đây là những điểm chính:

## 1. Các loại cược và quy tắc

Hệ thống có 8 loại cược chính với nhiều biến thể:

1. **Đầu Đuôi (dd)** - Cược 2 chữ số, áp dụng cả M1 và M2, tỷ lệ 1:75
2. **Xỉu Chủ (xc)** - Cược 3 chữ số, áp dụng cả M1 và M2, tỷ lệ 1:650
3. **Bao Lô (b2, b3, b4)** - Cược N chữ số, tỷ lệ thay đổi theo N (75, 650, 5500)
4. **Bao 7 Lô (b7l)** - Cược trên 7 lô cụ thể ở M1, tỷ lệ như Bao Lô
5. **Bao 8 Lô (b8l)** - Cược trên 8 lô cụ thể ở M2, tỷ lệ như Bao Lô
6. **Nhất To (nt)** - Cược dựa trên giải Nhất ở M2, tỷ lệ 1:75
7. **Xiên (x)** - Cược nhiều cặp số ở M2, tỷ lệ thay đổi (75, 40, 250)
8. **Đá (da)** - Cược nhiều cặp số ở M1, nhiều trường hợp trúng thưởng khác nhau

## 2. Các phương thức chọn số

Hệ thống hỗ trợ 6 phương thức chọn số:

1. **Nhập trực tiếp** - Người dùng nhập từng số
2. **12 Con Giáp** - Tạo số dựa trên 12 con giáp (Tý, Sửu, Dần, ...)
3. **Đảo Số** - Tạo hoán vị của một số (2, 3, hoặc 4 chữ số)
4. **Tài - Xỉu** - Tạo các số từ 50-99 (Tài) hoặc 00-49 (Xỉu)
5. **Chẵn - Lẻ** - Tạo các số chẵn hoặc lẻ từ 00-99
6. **Kéo Số** - Tạo số theo quy luật (kéo chục, kéo đơn vị, số đôi, số ba, số tiến)

## 3. Cấu trúc dữ liệu và database

Các artifacts đã cung cấp:

1. **lottery-data** - JSON chứa thông tin chi tiết về các loại cược và phương thức chọn số
2. **typescript-interfaces** - Định nghĩa interfaces TypeScript cho tất cả các đối tượng dữ liệu
3. **utility-functions** - Các hàm để tính toán tiền cược, số tiềm năng thắng, và xử lý kết quả
4. **lottery-structures** - Mô tả cấu trúc database Supabase cho hệ thống

## 4. Các hàm utility chính

1. **calculateBetAmount** - Tính tổng tiền đóng dựa trên loại cược, biến thể, miền, mệnh giá
2. **calculatePotentialWinAmount** - Tính số tiền tiềm năng thắng
3. **generateNumbers** - Tạo danh sách số tự động dựa trên phương thức chọn
4. **checkDauDuoiResult**, **checkBaoLoResult**, ... - Kiểm tra kết quả cho từng loại cược
5. **calculateWinAmount** - Tính tổng số tiền thắng dựa trên kết quả
